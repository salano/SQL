SELECT
				DISTINCT 
				SW.SUBSCRIBER_ID
				,E.ACCOUNT_NO
				,SUM(CASE WHEN DATEDIFF(day,sw.RECORD_TIMESTAMP, current_date) BETWEEN  0 AND  60  THEN SW.TOTAL_BYTES/1024/1024 END) AS days_60_MB
				,SUM(CASE WHEN DATEDIFF(day,sw.RECORD_TIMESTAMP, current_date) BETWEEN  0 AND  30  THEN SW.TOTAL_BYTES/1024/1024 END) AS days_30_MB
				,SUM(CASE WHEN DATEDIFF(day,sw.RECORD_TIMESTAMP, current_date) BETWEEN  0 AND  15  THEN SW.TOTAL_BYTES/1024/1024 END) AS days_15_MB
				,SUM(CASE WHEN DATEDIFF(day,sw.RECORD_TIMESTAMP, current_date) BETWEEN  0 AND  7  THEN SW.TOTAL_BYTES/1024/1024 END) AS days_7_MB
				,SUM(CASE WHEN DATEDIFF(day,sw.RECORD_TIMESTAMP, current_date) BETWEEN  0 AND  3  THEN SW.TOTAL_BYTES/1024/1024 END) AS days_3_MB
				,SUM(CASE WHEN DATEDIFF(day,sw.RECORD_TIMESTAMP, current_date) BETWEEN  0 AND  1 THEN SW.TOTAL_BYTES/1024/1024 END) AS days_1_MB
				
			FROM 
				ATNI_PROD.CDR.GTT_SANDVINE_WIRLESS SW 
				LEFT JOIN ATNI_PROD.GTT_REPORTING.EXTERNAL_ID_EQUIP_MAP_EXTRACT E 
				 		ON sw.SUBSCRIBER_ID = E.EXTERNAL_ID AND date(E.EXTRACT_FILE_DATE) = date(CURRENT_DATE()) AND E.IS_CURRENT  =1 
			WHERE date(sw.RECORD_TIMESTAMP) >= ADD_MONTHS(current_date, -3)
			 AND  E.INACTIVE_DATE IS NULL
			 AND E.EXTERNAL_ID_TYPE = 1
			GROUP BY 
				1, 2