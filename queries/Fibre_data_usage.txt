SELECT  
 to_char(date(DATE_PERIOD), 'YYYY-MM') Usage_month
 ,MSIDN 
 --,PROTOCOL 
 ,sum(TOTAL_NEW_CONNECTIONS) TOTAL_NEW_CONNECTIONS
 ,sum(TOTAL_RECEIVED_BYTES) TOTAL_RECEIVED_BYTES
 ,sum(TOTAL_TRANSMITTED_BYTES) TOTAL_TRANSMITTED_BYTES
FROM 
	ATNI_PROD.CDR.GTT_SANDVINE_WIRELINE

WHERE 
	date(DATE_PERIOD) BETWEEN to_date('2022-04-01','YYYY-MM-DD') AND to_date('2022-04-30','YYYY-MM-DD')
	AND LENGTH (MSIDN) >= 7
	AND TOTAL_RECEIVED_BYTES > 0
GROUP BY 
	1,2--,3
	
ORDER BY 
	1,2--,3